![トップ画像](https://github.com/take0603/nomishiro-bancho/blob/images/readme-logo.png)

# 目次
- [飲み代番長](#飲み代番長)
   - URL
   - 開発の背景
- [使用技術](#使用技術)
   - 技術スタック
   - システム構成図
   - ER図
- [機能および画面イメージ](#機能および画面イメージ)
- [本アプリ開発における所見](#本アプリ開発における所見)
   - こだわった部分
   - 課題・失敗した部分
   - 今後追加・対応したい内容
- [製作者個人について](#製作者個人について)
   - 自己紹介
   - これまで学習した内容とその目的
   - 今後学びたい内容

<br>

# 飲み代番長
飲み代番長(のみしろばんちょう)は飲み会等のイベントの進捗を管理することができます。  
複数の飲み会の進捗、出欠、精算の管理、およびそれらの補助ツールを使うことで、抜けや漏れをなくし効率化を図る幹事の方向けのサービスです。  


### URL
https://nomishiro-bancho-2b23287ae884.herokuapp.com

### 開発の背景
私が新卒で入社した会社では飲み会の調整や進行は新人の仕事でした。  
その際、出欠の確認や支払についてのアナウンスは個人PCのローカルでエクセルなどを用い管理していました。  
出欠表を作り、コピーし、支払用のフォーマットに書き換えたりといったことは煩雑で、学んだ技術で効率化できないかと考えたことがきっかけです。  

尚、サービス名の「飲み代番長」ですが、これは部署内で代々先輩から新人に渡されてきた傾斜精算用のエクセルのファイル名で、数字を入力すると各々の支払額を計算する数式が入ったシンプルな計算ツールでした。  
このエクセルをベースとし、その前後にも発生する作業を効率的に進められることを本アプリの目標としました。

<br>

# 使用技術
### 技術スタック
| 分類 | 詳細 |
| --- | --- |
| フロントエンド | HTML, CSS, JavaScript, Bootstrap |
| バックエンド | Ruby, Ruby on Rails |
| インフラ | Heroku |
| DB | PostgreSQL |
| 環境構築 | Docker, Docker Compose |
| テスト | RuboCop<br>RSpec<br>- 単体テスト(model, Helper)<br>- 機能テスト(request)<br>- 統合テスト(system)
| その他 | Git, GitHub |

<br>

### システム構成図
![システム構成図](https://github.com/take0603/nomishiro-bancho/blob/images/system_architecture.png)

### ER図
<img width="800" alt="ER図" src="https://github.com/take0603/nomishiro-bancho/blob/images/erd.png">

# 機能および画面イメージ
本アプリは大別して以下4カテゴリで構成されています。
- イベント　本アプリでの主要項目で出欠や支払いを紐付けて管理。イベント自体はユーザーに紐付く。
- 出欠　イベントの各候補日に対する出欠回答、全員の回答状況一覧。
- 支払　参加者別の支払額計算、支払状況の管理。
- マイページ　未消化タスクがあるイベントを進捗ステータス別で表示。

| トップページ画面 | ユーザー認証 |
| --- | --- |
| ![　トップ画面](https://github.com/take0603/nomishiro-bancho/blob/images/top.png) | ![ログイン画面](https://github.com/take0603/nomishiro-bancho/blob/images/login.png) |
| レスポンシブ対応 | ログイン / ログアウト / ゲストログイン<br>アカウント編集 / 削除 |

| イベント(飲み会)情報 |  |
| --- | --- |
| ![イベント作成画面](https://github.com/take0603/nomishiro-bancho/blob/images/event_new.png) | ![イベント表示画面](https://github.com/take0603/nomishiro-bancho/blob/images/event_show.png) |
| イベント・候補日の登録 / 編集 / 詳細 / 一覧 / 削除 | イベント登録で出欠表URLを発行<br>(出欠回答はユーザー認証を行わないため、URLのid部分はハッシュ値を使用) |

| 出欠表 |  |
| --- | --- |
| ![出欠回答画面](https://github.com/take0603/nomishiro-bancho/blob/images/attendance_new.png) | ![　出欠表表示画面](https://github.com/take0603/nomishiro-bancho/blob/images/attendance_show.png) |
| URLを回答者に案内しアプリ上で回答をもらう<br>出欠表関連はログイン不要 | 全員の候補日ごとの回答一覧表示<br>回答登録・変更・削除 |

| 支払表 |  |
| --- | --- |
| ![　支払表作成画面](https://github.com/take0603/nomishiro-bancho/blob/images/payment_new.png) | ![支払表表示画面](https://github.com/take0603/nomishiro-bancho/blob/images/payment_show.png) |
| 支払表・支払明細の登録 / 編集 / 詳細 / 一覧 / 削除<br>支払額計算機能(傾斜精算、端数処理複数パターン) | 支払表情報・支払明細の表示 |

| 進捗管理(マイページ) |
| --- |
| <img width=48% alt="マイページ画面" src="https://github.com/take0603/nomishiro-bancho/blob/images/mypage.png"> |
| 全員の精算まで完了していないタスクをステータスごとに表示<br>1.参加者が未確定、開催日未定<br>2.開催日確定、開催待ち<br>3.イベント終了、精算が未完了(参加者全員が支払済でない) |

<br>

# 本アプリ開発における所見
### こだわった部分
派手な技術の使用はありませんが、実際の利用者が違和感を持たないよう細部の作りに注力しました。  
また、個人開発ですが実務に向け仕組みを理解したかったため、Dockerによる環境構築やGitHub ActionsによるCI/CDを取り入れました。  
- 関連する要素の登録・編集は異なるモデルも1つのアクションで完結(例:イベントと候補日の登録、出欠回答者名と回答内容の登録)
- 出欠機能はユーザビリティを考慮しログイン不要に
- 利用者・状況に左右されるフォームの動的な追加・削除
- 出欠回答者はモバイル中心を想定したレスポンシブ対応
- 支払額計算の傾斜計算やよく使うであろう端数処理パターン
- ユーザーが取り得るケース、その事象を考慮(例:途中でイベントの候補日が追加された場合の出欠表や回答の表示など)
- 意図的なURL手打ち入力に対する対応(例:イベントidとそのイベントの作成者の照合、URLのハッシュ値利用など)

### 課題・失敗した部分
- 中途半端にBootstrapを使用してしまったために、パフォーマンス、保守の面共にバランスが悪い
- 中間テーブルの扱い、ネストしたフォームからの複数モデルへの一括登録で苦戦し、パフォーマンス面で無駄が多い(n+1発生など)
- アプリURLが独自ドメインではなく、様々な面で不利

### 今後追加・対応したい内容
- n+1が発生している箇所の対応
- 問い合わせフォーム
- 出欠表URLをワンクリックでクリップボードへコピー
- 店舗検索やお気に入り機能(イベントに開催場所を紐づけるような用途、スクレイピングかホットペッパーAPIなど？)
- 領収証アップロード機能（現状テキストベースの金額しか載せられないため、領収証画像を支払表に紐付け）
- 支払表のPDF(など)出力機能
- 出欠回答のAjax化(出欠表表示と回答をページ遷移なしで)
